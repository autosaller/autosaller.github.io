function displayNotification(type,text){displayNotificationHelper(type,text,false);}
function displayNotificationHelper(type,text,nohide){if(type=='error')text=text.replace('Error:','');if(text=='')return;if(text.indexOf('accounts')>=0){showHideAuths(text);return;}
if(nohide){new Noty({layout:"topRight",type:type,text:text,}).show();}else{new Noty({layout:"topRight",progressBar:true,timeout:5000,type:type,text:text,}).show();}}
$(function(){if($('[data-toggle="tooltip"]').length)$('[data-toggle="tooltip"]').tooltip();localizeDates();});$('.showBilling').click(function(){$("#payid").val($(this).attr('data-href'));$('#billingModal .btn').html('Continue');$('#billingModal').modal('show');});$(window).scroll(function(){var sticky=$('.sticky'),scroll=$(window).scrollTop();if(scroll>=75)sticky.addClass('fixed');else sticky.removeClass('fixed');});$('.giveaway-tr').click(function(){var url=$(this).attr('data-url');if(url)window.location.href=url;return;});$('.mobile-button').click(function(){$(this).parent().toggleClass('open');});$('.showLoginEmail').click(function(){$('#loginModal').addClass('active').removeClass('register');});$('.showLoginSocial').click(function(){$('#loginModal').removeClass('active register');});$('.showRegisterEmail').click(function(){$('#loginModal').addClass('register');});$(document).on('click','.showModal',function(){$('#'+$(this).attr('data-modal')).modal('show');});$('.report').click(function(){if($(this).attr('data-prize'))$('#reportSubmit').attr('data-id',$(this).attr('data-prize'));});$('#table-1').paginate({limit:10});$('#table-2').paginate({limit:10});$('#table-3').paginate({limit:10});$('#table-4').paginate({limit:10});$('#table-5').paginate({limit:10});$('#table-6').paginate({limit:10});$('#table-entries').paginate({limit:30});$('#table-entries2').paginate({limit:30});$(document).on('click','.btnModal',function(){var link=$(this).attr('data-href');var title=$(this).attr('title');if(title=='End now'){$('#actionsModal').modal('hide');$('#endModal a').attr('href',link);$('#endModal').modal('show');}
if(title=='Delete'){$('#actionsModal').modal('hide');$('#deleteModal a').attr('href',link);$('#deleteModal').modal('show');}});$(document).on('click','.copy',function(){$(this).select();if(window.getSelection().toString()){document.execCommand("copy");displayNotification('success','Copied to clipboard...');}});$(document).on('click','.socialAuth a',function(){if($(this).hasClass('email'))return;if($(this).attr('href')=='/recover-password')return;if($('body').hasClass('is-mobile')&&!$('body').hasClass('is-embed'))return window.location.href=$(this).attr('data-href');$('body').addClass('loading authorizing');var authType='social';if($(this).hasClass('integration'))authType='integration';$('.spinner').html('<div>Redirecting you once '+authType+' login is complete...<br /><small>Having trouble? <a href="">Try again</a></small></div>');$.oauthpopup({path:$(this).attr('data-href'),callback:function(){if($('#redirect').val())return window.location.href=$('#redirect').val();return window.location.reload();}});});$(document).on('click','.pop',function(){window.open($(this).attr('data-href'),'_blank');});$('#reportSubmit').click(function(e){e.preventDefault();$.ajax({type:$('#reportForm').attr('method'),url:$('#reportForm').attr('action'),data:{type:$(this).attr('data-type'),report_id:$(this).attr('data-id'),reason:$('#reportReason').val(),email:$('#email').val(),captcha:$('.captcha-response').val(),}}).done(function(data){if(data=='success'){$('#reportModal .modal-body').html('Report has been submitted. Thank you for your feedback.');}else{displayNotification('error',data);}});});function param(name){return(location.search.split(name+'=')[1]||'').split('&')[0];}
$(document).on('submit','#loginForm',function(e){e.preventDefault();if(!$(this).find('#loginEmail').val())return displayNotification('error','Email is required.');if(!$(this).find('#loginPassword').val())return displayNotification('error','Password is required.');$.ajax({type:$(this).attr('method'),url:$(this).attr('action'),data:$(this).serializeArray(),}).done(function(data){if(data=='success'){if($('#redirect').val())return window.location.href=$('#redirect').val();return window.location.reload();}
displayNotification('error',data);});});$(document).on('submit','#registerForm',function(e){e.preventDefault();if($(this).find('#first_name').length){if(!$(this).find('#first_name').val())return displayNotification('error','First name is required.');if(!$(this).find('#last_name').val())return displayNotification('error','Last name is required.');}else{if(!$('#registerForm #displayName').val())return displayNotification('error','Display name is required.');if(!$('#registerForm #password').val())return displayNotification('error','Password is required.');if($('#registerForm #password').val()!=$('#registerForm #password_confirm').val())return displayNotification('error','Passwords do not match.');}
if(!$(this).find('#email').val())return displayNotification('error','Email is required.');$.ajax({type:$(this).attr('method'),url:$(this).attr('action'),data:$(this).serializeArray(),}).done(function(data){if(data=='success'){if($('#redirect').val())return window.location.href=$('#redirect').val();return window.location.reload();}
if(data.indexOf('accounts')>=0){showHideAuths(data);return;}
displayNotification('error',data);});});$(document).on('click','.socialAuth .goback',function(e){e.preventDefault();$('.embed.socialAuth').removeClass('login');$('.embed .moreSocial a').removeClass('hidden');$('.embed .moreSocial a.hidden2').addClass('hidden');$('.embed #loginForm + h6').remove();$('.embed #loginForm + p').remove();});$(document).on('submit','#contactForm',function(e){e.preventDefault();if(!$(this).find('#name').val())return displayNotification('error','Name is required.');if(!$(this).find('#email').val())return displayNotification('error','Email is required.');if(!$(this).find('#subject').val())return displayNotification('error','Subject is required.');if(!$(this).find('#message').val())return displayNotification('error','Message is required.');$.ajax({type:$(this).attr('method'),url:$(this).attr('action'),data:$(this).serializeArray(),}).done(function(data){if(data=='success'){$('#contactForm').slideUp().after('<p>Thank you! Your message has been sent.</p>');}else{displayNotification('error',data);}});});$('.uniqueEmail').on('keyup',function(){setTimeout(isUnique,250);});function isUnique(){var email=$('.uniqueEmail').val();if($.trim(email.length)==0)return;$.ajax({type:"POST",url:"/unique-email",data:{email:email,}}).done(function(data){$('.tooltip').remove();$('.uniqueEmail').parent().addClass('rel');$('.uniqueEmailMessage').remove();var toShow='<i class="fas fa-times error" data-toggle="tooltip" data-placement="left" title="'+data+'"></i>';if(data=='you')toShow='<i class="fas fa-check-circle verified" data-toggle="tooltip" data-placement="left" title="That\'s you!"></i>';if(data=='valid')toShow='<i class="fas fa-check-circle verified" data-toggle="tooltip" data-placement="right" title="Valid email"></i>';$('.uniqueEmail').after('<div class="uniqueEmailMessage">'+toShow+'</div>');$('.uniqueEmailMessage i').tooltip();});}
$('.uniqueSlug').on('keyup',function(){setTimeout(isUniqueSlug,250);});function isUniqueSlug(){var slug=$('.uniqueSlug').val();var myslug=$('.uniqueSlug').attr('data-slug');if($.trim(slug.length)==0)return;$.ajax({type:"POST",url:"/unique-slug",data:{slug:slug,myslug:myslug,}}).done(function(data){$('.tooltip').remove();$('.uniqueSlug').parent().addClass('rel');$('.uniqueSlugMessage').remove();var toShow='<i class="fas fa-times error" data-toggle="tooltip" data-placement="left" title="'+data+'"></i>';if(data=='you')toShow='<i class="fas fa-check-circle verified" data-toggle="tooltip" data-placement="left" title="That\'s your URL!"></i>';if(data=='valid')toShow='<i class="fas fa-check-circle verified" data-toggle="tooltip" data-placement="right" title="Valid URL"></i>';$('.uniqueSlug').after('<div class="uniqueSlugMessage">'+toShow+'</div>');$('.uniqueSlugMessage i').tooltip();});}
function localizeDates(){$('.localizeDate').each(function(){var date=new Date($(this).attr('data-date'));var format='MM/dd/yyyy h:mm a';if($(this).attr('data-format'))format=$(this).attr('data-format');$(this).html($.format.date(date,format));});}
$(document).on('submit','#settingsForm',function(e){e.preventDefault();$.ajax({type:$('#settingsForm').attr('method'),url:$('#settingsForm').attr('action'),data:$('#settingsForm').serializeArray(),}).done(function(data){if(data=='success'||data=='success2'){$('#emailSettingsModal').addClass('emailFinished').modal('hide');if(data=='success')return displayNotification('success','Your profile has been updated.');if(data=='success2'){if($('#settingsForm button').text()=='Enable'){$('#settingsForm button').html('Disable');}else if($('#settingsForm button').text()=='Disable'){$('#settingsForm button').html('Enable');}
return displayNotification('success','Your settings has been updated.');}}
displayNotification('error',data);}).fail(function(jqXHR,textStatus,errorThrown){displayNotification('error','Failed to submit form. Please try again later. If this issue persists, please contact support.');});});$(document).on('touchend',function(event){$('.fa-info-circle').tooltip('hide');if(event.target.classList.contains('fa-info-circle'))$(event.target).tooltip('show');});$(document).on('click','.download',function(e){var $this=$(this);if($('#filterUsersTable')||$('#filterEntriesTable')){e.preventDefault();var exportUrl=$this.attr('data-href');if($('#filterGiveawaySlug').val())exportUrl+='&giveaway_slug='+$('#filterGiveawaySlug').val();if($('#filterStepIds').val())exportUrl+='&step_ids='+$('#filterStepIds').val();if($('#filterUserSlug').val())exportUrl+='&user_slug='+$('#filterUserSlug').val();if($('#filterType').val())exportUrl+='&type='+$('#filterType').val();window.location.href=exportUrl;return;}
if($this.hasClass('disabled')){e.preventDefault();return;}
$this.addClass('disabled').html('Processing');setTimeout(function(){$this.removeClass('disabled').html('Export CSV');},5000);displayNotification('success','Your export is being generated. This may take some time for larger giveaways.');});$(document).on('click','#previewSteps',function(){$(this).hide();$('.g-cont').removeClass('g-not-started');});$(document).on('click','.pricing-plans ul + a',function(){$('html, body').animate({scrollTop:$('.pricing-chart').offset().top-56});});$(document).on('click','.sendMessage',function(e){var messageLink=$(this).attr('href');var emailLink=$(this).attr('data-email');if(emailLink){e.preventDefault();$('#messageModal .btn1').attr('href',messageLink);$('#messageModal .btn2').attr('href','mailto:'+emailLink);$('#messageModal').modal('show');}});$(document).on('click','form .btn',function(e){if($('.captcha-response').length>0){e.preventDefault();var $this=$(this);var btnMessage=$this.html();$this.html('Please Wait');grecaptcha.execute($('.captcha-response').attr('data-site'),{action:'submit'}).then(function(token){$('.captcha-response').val(token);$this.html(btnMessage);$this.closest('form').submit();});}});var onloadCallback=function(){if($('.captcha-response').length>0){$('body').append('<div id="g-recaptcha"></div>');grecaptcha.render('g-recaptcha',{'sitekey':$('.captcha-response').attr('data-site'),'size':'invisible',},true);}}
$('.toggleCycle span').click(function(){$('.toggleCycle span').removeClass('active');$(this).addClass('active');$('.month-cycle').removeClass('hidden-cycle');if($(this).attr('data-cycle')=='yearly')$('.month-cycle').addClass('hidden-cycle');});$('.toggleCouponBox').click(function(){$('.discountContainer').addClass('active');});function discountCode(){var canUseDiscount=$('#canUseDiscount').val();var coupon_success=false;var coupon_message='<i class="fas fa-info-circle"></i> Please enter a valid code.';var discount_code=$('#discount_code').val().toLowerCase();var premiumNew1='9';var businessNew1='29';var premiumNew2=businessNew2='99';if(discount_code=='first50'||discount_code=='33off3months'){if(canUseDiscount){coupon_success=true;if(discount_code=='first50'){premiumNew1='4';businessNew1='14';premiumNew2=businessNew2='99';coupon_message='<i class="fas fa-check-circle"></i> Your coupon has been applied. Your first month is now 50% off.';}
if(discount_code=='33off3months'){premiumNew1='6';premiumNew2='69';businessNew1='20';businessNew2='09';coupon_message='<i class="fas fa-check-circle"></i> Your coupon has been applied. Your first 3 months will now be 33% off.';}}else{coupon_message='<i class="fas fa-info-circle"></i> It looks like you’ve previously subscribed with us. This promotion is only available for new subscribers currently.';}}
$('.month-cycle.bg2 h1').html('<sup>$</sup>'+premiumNew1+'<sup>'+premiumNew2+'</sup><small>/ month</small>');$('.month-cycle.bg3 h1').html('<sup>$</sup>'+businessNew1+'<sup>'+businessNew2+'</sup><small>/ month</small>');if($('.month-cycle.bg2 a').text()=='Get Premium')$('.month-cycle.bg2 a').attr('href','/pricing/premium?discount_code='+discount_code);if($('.month-cycle.bg3 a').text()=='Get Business')$('.month-cycle.bg3 a').attr('href','/pricing/business?discount_code='+discount_code);var coupon_class=coupon_success?'alert-success':'alert-warning';$('#discountMesssage').show().removeClass('alert-success alert-warning').html(coupon_message).addClass(coupon_class);}
$('.discountContainer .btn').click(function(){discountCode();});$('#discount_code').on('keyup',function(e){if(e.keyCode===13)discountCode();});$('a[data-confirm]').click(function(ev){var href=$(this).attr('href');if(!$('#dataConfirmModal').length)$('body').append('<div id="dataConfirmModal" class="modal" role="dialog" aria-labelledby="dataConfirmLabel" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="dataConfirmLabel">Please Confirm</h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"></div><div class="modal-footer"><button class="btn btn-secondary" data-dismiss="modal" aria-hidden="true">Cancel</button><a class="btn" id="dataConfirmOK">Unlink</a></div></div></div></div>');$('#dataConfirmModal').find('.modal-body').text($(this).attr('data-confirm'));$('#dataConfirmOK').attr('href',href);$('#dataConfirmModal').modal({show:true});return false;});function showHideAuths(data){if($('.entries-container').length){if(!$('.embed.socialAuth').length){var dropdownContents='';if(document.getElementById('giveSocials'))dropdownContents+=document.getElementById('giveSocials').outerHTML;if(document.getElementById('registerForm'))dropdownContents+=document.getElementById('registerForm').outerHTML+document.getElementById('loginForm').outerHTML;$('.entries-container').prepend('<div class="embed socialAuth">'+dropdownContents+'</div>');$('.entries-container .socialAuth').show();}
$('.embed.socialAuth').addClass('login');$('.embed .moreSocial a.hidden').addClass('hidden2');$('.embed .moreSocial a').addClass('hidden');if(data.indexOf('email')>=0){$('.embed .moreSocial .email').removeClass('hidden');}else{$('.embed.socialAuth > h6, .embed.socialAuth > p').remove();$('.embed #loginForm').hide().after('<h6>It looks like you\'ve entered another giveaway before. Try logging in with a linked social network above.</h6><p class="center"><small><span class="goback">Start over</span> or <a href="/recover-password">Recover your account</a></small></p>');}
if(data.indexOf('youtube')>=0)$('.embed .moreSocial .youtube').removeClass('hidden');if(data.indexOf('twitter')>=0)$('.embed .moreSocial .twitter').removeClass('hidden');if(data.indexOf('facebook')>=0)$('.embed .moreSocial .facebook').removeClass('hidden');if(data.indexOf('twitch')>=0)$('.embed .moreSocial .twitch').removeClass('hidden');if(data.indexOf('discord')>=0)$('.embed .moreSocial .discord').removeClass('hidden');if(data.indexOf('reddit')>=0)$('.embed .moreSocial .reddit').removeClass('hidden');if(data.indexOf('steam')>=0)$('.embed .moreSocial .steam').removeClass('hidden');if(data.indexOf('email')>=0)$('.embed .moreSocial .email').removeClass('hidden');}else{displayNotification('error','It looks like you already have an account. Please try logging in with an already linked social network.');}}